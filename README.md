# ETCGDemo
修改记录
1、去掉单独连接激光和天线的方法，封装Socket类

2、修复编辑距离算法中可能出现车牌为null时，报异常

3、修复UI更新显示，去掉委托修改为线程取缓存方式更新

4、修改位置匹配，区分有定位和无定位天线

5、修改匹配开关，增加位置匹配，车牌模糊匹配

6、修改匹配开关，由于用户可能懒得去开开关，将开关防止配置功能选项卡中，用默认方式配置

7、增加强制匹配，当完成一次正常匹配，对链表结构体进行一次可尝试匹配。如果存在可尝试匹配，进行一次强制匹配（一般用于抓取套牌车，识别车牌与实际OBU车牌不一致导致无法正常匹配）

8、修改抓拍与出车位置不是同一位置时，激光与摄像机匹配

9、修改匹配逻辑，修复当位置一致车牌不一致时匹配，导致后续无法匹配

10、修改Socket类，增加字节发送接口

11、修复软件关闭后，后台线程依然继续运行情况

12、修复Socket未能正常关闭导致下一次连接，额外建立连接情况

13、使用串口服务器，修复ACK回复延时、数据重发等问题

14、修复软件关闭时，界面渲染异常导致程序崩溃

15、修复车牌为null时，数据匹配异常

16、修复摄像机数据先到，激光数据帧后到，导致激光数据等待摄像机超时，激光数据未能与摄像机数据匹配

17、增加线程间相互等待，防止抢占

18、增加IPC，IPNC，HC等摄像机接口，可同时兼容

19、修改配置文件，使用公用摄像机IP，避免不同品牌额外增加配置

20、增加监控程序，防止程序异常崩溃，监控与主程序相互监控，异常崩溃时立即启动

21、增加软件启动记录日志

22、日志记录时间精确到毫秒

23、开放UI界面日志记录后台日志开关，可记录界面日志


还存在问题：
1、摄像机数据到来时间理论比激光数据到达时间晚，但是存在摄像机先到，通过网络抓包发现，并非网络延时问题，数据发送时间距离接收时间小于10ms，但是摄像机通过IO触发到完成图片的存储，约300毫秒，从进入回调函数到得到车牌结果约10毫秒，从进入回调到置信号量时间约50毫秒。理论上已经远远超过数据帧时间。虽然问题已经解决，但是原因未能找到

2、摄像机抓拍延时问题，偶尔存在摄像机抓拍延时较长，达2~3秒，即激光数据82帧到达，等待2~3秒后才收到摄像机的数据（程序设计超时时间为1200毫秒，2000毫秒以上可能影响程序的时效性）

3、数据帧丢失情况，目前发现存在82帧数据丢失，但是摄像机数据正常，可能由于数据丢帧导致
